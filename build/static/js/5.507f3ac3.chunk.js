(this["webpackJsonpoivan-cl"]=this["webpackJsonpoivan-cl"]||[]).push([[5],{543:function(e,t,i){},544:function(e,t,i){},568:function(e,t,i){"use strict";i.r(t),i.d(t,"HomePage",(function(){return k}));var r=i(0),n=i(94),a=i(523),c=i.n(a),s=i(245),o=i(524),l=i(501),d=i(506),u=i(502),h=i(509),p=i(508),g=i(16),m=i(67),b=i(525),j=i.n(b),v=i(566),f=(i(543),i(18));function O(e){var t=e.loadMore;return Object(f.jsx)("div",{className:"base-loading".concat(t?" load-more":""),children:Object(f.jsx)("img",{src:t?"https://cutewallpaper.org/21/loading-gif-transparent-background/Loading-GIF-on-Inspirationde.gif":"https://cutewallpaper.org/21/loading-animated-gif-transparent-background/Twilight-on-the-olympic-peninsula.gif",alt:"Loading"})})}i(544);var x=function(e){Object(h.a)(i,e);var t=Object(p.a)(i);function i(e){var r;Object(l.a)(this,i),(r=t.call(this,e)).inProcess=void 0,r.timerId=void 0,r.firstLoad=void 0;var n=r.props,a=n._articles,c=n._pageNumber;return r.state={articles:JSON.parse(JSON.stringify(a)),pageNumber:c,loading:a.length?1:0,shouldRedirect:!1},r.renderArticle=r.renderArticle.bind(Object(u.a)(r)),r.onScroll=r.onScroll.bind(Object(u.a)(r)),r.inProcess=!1,r.timerId=setTimeout((function(){})),r.firstLoad=!0,r}return Object(d.a)(i,[{key:"onScroll",value:function(){var e=this;if(this.props.articleIndex>-1&&(clearTimeout(this.timerId),this.timerId=setTimeout((function(){e.firstLoad=!1}),1e3),!this.firstLoad)){var t=document.querySelector(".highlight");t&&t.classList.remove("highlight")}window.innerHeight+window.scrollY>=document.body.offsetHeight&&(this.inProcess||(this.inProcess=!0,this.query()))}},{key:"componentDidMount",value:function(){var e=this.props,t=e._articles,i=e.articleIndex;t.length?setTimeout((function(){var e=document.querySelector('[data-index="'.concat(i,'"]'));e&&e.classList.add("highlight")}),1e3):this.query(),window.addEventListener("scroll",this.onScroll)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.onScroll)}},{key:"query",value:function(){var e=Object(o.a)(c.a.mark((function e(){var t,i,r,n,a,o,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,i=t.pageNumber,r=t.loading,n=t.articles,r&&this.setState({loading:2}),e.prev=2,e.next=5,j.a.post("https://iwa-test.herokuapp.com/graphql",{query:"query Articles($pageNumber: Int) {\n                    articles(pageNumber: $pageNumber) {\n                      content,\n                      coverImageUrl,\n                      description,\n                      subtitle,\n                      title,\n                      url\n                    }\n                }",variables:{pageNumber:i}});case 5:(a=e.sent).data.data.articles.length&&(o=[].concat(Object(s.a)(n),Object(s.a)(a.data.data.articles)),this.props.saveArticles(o),this.setState({articles:o,pageNumber:i+1}),this.inProcess=!1),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(2),this.inProcess=!1,console.log("GraphQL failed!"),console.error(e.t0);case 14:return e.prev=14,l=this,setTimeout((function(){l.setState({loading:1})}),1e3),e.finish(14);case 18:case"end":return e.stop()}}),e,this,[[2,9,14,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleOnClickArticle",value:function(e,t){"A"!==e.target.nodeName&&(this.props.selectArticle(t),this.props.savePage(this.state.pageNumber),this.setState({shouldRedirect:!0}))}},{key:"checkImgDimesion",value:function(e){e.classList.remove("default-height"),e.naturalWidth<100&&e.parentNode.parentNode.classList.add("hide-img")}},{key:"renderArticle",value:function(e){var t=this,i=e.index,r=e.data,n=(r.content,r.coverImageUrl),a=r.title,c=r.url,s=r.description,o=r.subtitle;return Object(f.jsxs)("div",{className:"article",onClick:function(e){return t.handleOnClickArticle(e,i)},"data-index":i,children:[Object(f.jsxs)("div",{className:"article__title",children:[Object(f.jsx)("h3",{children:Object(f.jsx)("a",{href:c,target:"_blank",rel:"noreferrer",children:decodeURIComponent(escape(a))})}),Object(f.jsx)("i",{children:o})]}),Object(f.jsx)("div",{className:"article__image",style:{backgroundImage:"url(".concat(null===n||""===n?"https://i.stack.imgur.com/y9DpT.jpg":n,")")},children:Object(f.jsx)("img",{className:"default-height",src:null===n||""===n?"https://i.stack.imgur.com/y9DpT.jpg":n,alt:"",onLoad:function(e){t.checkImgDimesion(e.target)}})}),Object(f.jsx)("div",{className:"article__description",children:Object(f.jsx)("p",{children:s})})]},c)}},{key:"render",value:function(){var e=this.state,t=e.articles,i=e.loading;return e.shouldRedirect?Object(f.jsx)(g.a,{to:"/article"}):Object(f.jsxs)("div",{className:"articles",children:[Object(f.jsx)("h1",{children:"Hacker News"}),i&&t.length?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(v.a,{items:t,columnGutter:10,columnWidth:300,overscanBy:5,render:this.renderArticle,itemHeightEstimate:window.innerHeight,scrollToIndex:this.props.articleIndex<0?void 0:this.props.articleIndex}),2===i&&Object(f.jsx)(O,{loadMore:!0})]}):Object(f.jsx)(O,{loadMore:!1})]})}}]),i}(r.Component),y=Object(m.c)((function(e){return{_articles:e.article.articles,_pageNumber:e.article.pageNumber,articleIndex:e.article.articleIndex}}),(function(e){return{selectArticle:function(t){return e({type:"SELECT_ARTICLE",payload:t})},saveArticles:function(t){return e({type:"SAVE_ARTICLES",payload:t})},savePage:function(t){return e({type:"SAVE_PAGE",payload:t})}}}))(x);function k(){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(n.a,{children:[Object(f.jsx)("title",{children:"Home Page"}),Object(f.jsx)("meta",{name:"description",content:"A Boilerplate application homepage"})]}),Object(f.jsx)(y,{})]})}}}]);